<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>README.md</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <link rel="stylesheet" href="../css/reset.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../css/main.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../css/github.css" type="text/css" media="screen" />
<script src="../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
<script src="../js/jquery-effect.js" type="text/javascript" charset="utf-8"></script>
<script src="../js/main.js" type="text/javascript" charset="utf-8"></script>
<script src="../js/highlight.pack.js" type="text/javascript" charset="utf-8"></script>

</head>

<body>     
    <div class="banner">
        
        <h1>
            README.md
        </h1>
        <ul class="files">
            <li>README.md</li>
            <li>Last modified: 2017-03-21 12:53:04 +0700</li>
        </ul>
    </div>

    <div id="bodyContent">
        <div id="content">
  
    <div class="description">
      
<h1 id="label-plaid-ruby+rdoc-image-3Ahttps-3A-2F-2Fcircleci.com-2Fgh-2Fplaid-2Fplaid-ruby.svg-3Fstyle-3Dsvg-26circle-token-3D30ee002ac2021da5b5b5a701d45fe2888af124a5+rdoc-image-3Ahttps-3A-2F-2Fbadge.fury.io-2Frb-2Fplaid.svg">plaid-ruby <a href="https://circleci.com/gh/plaid/plaid-ruby"><img src="https://circleci.com/gh/plaid/plaid-ruby.svg?style=svg&circle-token=30ee002ac2021da5b5b5a701d45fe2888af124a5"></a> <a href="http://badge.fury.io/rb/plaid"><img src="https://badge.fury.io/rb/plaid.svg"></a></h1>

<p>The official Ruby bindings for the <a href="https://plaid.com/docs">Plaid
API</a>.</p>

<p><strong>Note:</strong> This module was recently refactored and released as
version <code>4.0.x</code> to support <a
href="https://blog.plaid.com/improving-our-api/">Plaid’s updated API</a>.
The previous module version, <code>3.0.x</code>, and API legacy
documentation, is still available via RubyGems and mirrored as <a
href="https://github.com/plaid/plaid-ruby-legacy">plaid-legacy</a>.</p>

<h2 id="label-Installation">Installation</h2>

<p>Add this line to your application&#39;s Gemfile:</p>

<pre><code>gem &#39;plaid&#39;
</code></pre>

<p>And then execute:</p>

<pre><code>$ bundle</code></pre>

<p>Or install it yourself as:</p>

<pre><code>$ gem install plaid</code></pre>

<p>The gem supports Ruby 2.1+ only.</p>

<h2 id="label-Usage">Usage</h2>

<p>This gem wraps the <a href="../classes/Plaid.html">Plaid</a> API, which is
fully described in the <a
href="https://plaid.com/docs/api">documentation</a>.</p>

<p>The RubyDoc for the gem is available <a href="LINKPLACEHOLDER">here</a>.</p>

<h3 id="label-Creating+a+Plaid+client">Creating a <a href="../classes/Plaid.html">Plaid</a> client</h3>

<p>Create an instance of the client using the <code>client_id</code>,
<code>secret</code>, and <code>public_key</code> from your <a
href="../classes/Plaid.html">Plaid</a> dashboard along with your
environment of choice:</p>

<pre><code>require &#39;plaid&#39;

$client = Plaid::Client.new(env: :sandbox,
                            client_id: &#39;***&#39;,
                            secret: &#39;***&#39;,
                            public_key: &#39;***&#39;)
</code></pre>

<p>The <code>env</code> field is the environment which the client will be
running in. Your choices for the <code>env</code> field include: -
<code>:sandbox</code> allows you to do your initial integrations tests
against preloaded data without being billed or making expensive API calls.
More information about using the API sandbox can be found on the <a
href="https://plaid.com/docs/api/blob/master/SANDBOX.md">API Sandbox
documentation</a>. - <code>:development</code> allows you to test against
both real and test accounts without being billed. More information about <a
href="../classes/Plaid.html">Plaid</a> test accounts can be found in our <a
href="https://plaid.com/docs/api/#sandbox">API documentation</a>. -
<code>:production</code> is the production environment where you can launch
your production ready application and be charged for your <a
href="../classes/Plaid.html">Plaid</a> usage.</p>

<h3 id="label-Creating+a+new+item">Creating a new item</h3>

<p>A new item can be created by providing a set of credentials, an institution
code, and a list of products to create the item with.</p>

<pre><code>item = client.item.create(credentials: { username: &#39;user_good&#39;,
                                         password: &#39;pass_good&#39;,
                                         pin: &#39;1234&#39; },
                          institution_id: &#39;ins_109509&#39;,
                          initial_products: %i(auth identity transactions))
</code></pre>

<p>The first argument for <code>client.item.create</code> is always the
credentials in the form of a hash. <code>ruby credentials = { username:
&#39;user_good&#39;,                 password: &#39;pass_good&#39;,        
pin: &#39;1234&#39; } </code> The <code>pin</code> field in the credentials
hash is not required and does not need to be entered if your institution
does not require it.</p>

<p>A successful, non-MFA (multi-factor authentication) response (HTTP 200) to
an item creation will come in the form of a hash where each of these
attributes can be accessed by the corresponding string key: <code>ruby {
&quot;access_token&quot; =&gt; String,   &quot;item&quot; =&gt; {
&quot;available_products&quot; =&gt; [String],              
&quot;billed_products&quot;    =&gt; [String],              
&quot;error&quot;              =&gt; Object,              
&quot;institution_id&quot;     =&gt; String,              
&quot;item_id&quot;            =&gt; String,              
&quot;webhook&quot;            =&gt; nullable String },  
&quot;request_id&quot; =&gt; String } </code> The response provides three
primary pieces of information: - <code>access_token</code> is your token to
access this item and the item&#39;s products in the future such as
<code>auth</code> or <code>transactions</code> - <code>item</code> provides
information about the item such as the <code>item_id</code> and
<code>available_products</code> - <code>request_id</code> is the identifier
for your actual request, this is often used to file tickets if necessary</p>

<p>There are other responses you can receive from an item creation such as an
MFA response and an error response (they&#39;re all in hash form).</p>

<p>An MFA response (HTTP 210) looks like this: <code>ruby {
&quot;access_token&quot; =&gt; String,   &quot;device&quot;       =&gt;
nullable String,   &quot;device_list&quot;  =&gt; nullable [Object],  
&quot;mfa_type&quot;     =&gt; String Enum (device, device_list, questions,
selections),   &quot;questions&quot;    =&gt; nullable [String],  
&quot;request_id&quot;   =&gt; String,   &quot;selections&quot;   =&gt;
nullable [Object] } </code></p>

<p>An example of how an MFA onboarding flow looks like can be seen below in
the Examples section.</p>

<p>If an error occurs during the creation, an error will be thrown. The class
for the error has values that you can access by using the following keys.
<code>ruby { "error_type"      => String,   "error_code"      => String,  
"error_message"   => String,   "display_message" => (nullable) String,  
"request_id"      => String }  Additional information on the meaning or
usage of each field can be found in our {API Error
documentation}[https://plaid.com/docs/api#errors]</code>.</p>

<p>You can also add options such as <code>transactions.await_results</code> or
<code>webhook</code> to your item creation, use keyed arguments:</p>

<pre><code>item = client.item.create(credentials: { username: &#39;user_good&#39;,
                                         password: &#39;pass_good&#39; },
                          institution_id: &#39;ins_109509&#39;,
                          initial_products: %i(auth identity transactions),
                          transactions_await_results: true,
                          webhook: &#39;https://plaid.com/webhook-test&#39;)
</code></pre>

<p>More information about item creation options can be found in our <a
href="https://plaid.com/docs/api#post-itemcreate">API documentation</a>.</p>

<h2 id="label-Examples">Examples</h2>

<h3 id="label-Exchanging+a+Link+public+token+for+a+Plaid+access_token">Exchanging a Link public token for a <a href="../classes/Plaid.html">Plaid</a> access_token</h3>

<p>If you have a <a href="https://github.com/plaid/link">Link</a> <code>public
token</code>, use this function to get an <code>access_token</code>:
<code>client.item.public_token.exchange(public_token)</code></p>

<p>An example of the function&#39;s usage if you have a
<code>public_token</code> in hand:</p>

<pre><code>response = client.item.public_token.exchange(public_token)
access_token = response[&#39;access_token&#39;]
</code></pre>

<h3 id="label-Handle+MFA+during+item+creation">Handle MFA during item creation</h3>

<p>If MFA is requested by the financial institution, there will be additional
steps required to finish the item creation flow: “`ruby require
&#39;plaid&#39;</p>

<p>def answer_mfa(client, access_token, data)  case <a
href="'mfa_type'">data</a>  when &#39;questions&#39; 
answer_questions(client, access_token, <a href="'questions'">data</a>) 
when &#39;device_list&#39;  answer_device_list(client, access_token, <a
href="'device_list'">data</a>)  when &#39;selections&#39; 
answer_selections(client, access_token, <a href="'selections'">data</a>) 
when &#39;device&#39;  answer_device(client, access_token, <a
href="'device'">data</a>)  else  raise &#39;Unknown MFA type from
Plaid&#39;  end end</p>

<p>def answer_questions(client, access_token, _questions)  # We have magically
inferred the answer here, so we respond immediately.  # In the real world,
we would present the questions to our user and  # submit their responses. 
answers = [&#39;answer_0_0&#39;]  client.item.mfa(access_token,
&#39;questions&#39;, answers) end</p>

<p>def answer_device_list(client, access_token, device_list)  # We have picked
the first device here.  # In the real world, we would ask our user which
device the passcode  # should be sent to.  device = <a
href="0">device_list</a>[&#39;device_id&#39;] 
client.item.mfa(access_token, &#39;device_list&#39;, [device]) end</p>

<p>def answer_device(client, access_token, _device)  # Another magically
inferred answer.  # In the real world, we would ask our user for the
passcode they received.  client.item.mfa(access_token, &#39;device&#39;,
[&#39;1234&#39;]) end</p>

<p>def answer_selections(client, access_token, _selections)  # We have
magically inferred the answer here, so we respond immediately.  # In the
real world, we would present the selection question and choices  # to our
user and submit their responses.  answers = %w(tomato ketchup) 
client.item.mfa(access_token, &#39;selections&#39;, answers) end</p>

<p>begin  client = <a
href="../classes/Plaid/Client.html#method-c-new">Plaid::Client.new</a>(env:
:sandbox,  client_id: &#39;<strong><em>&#39;,  secret:
&#39;</em></strong>&#39;,  public_key: &#39;<em>*</em>&#39;)</p>

<p>response = client.item.create(credentials: { username: &#39;user_good&#39;,
password: &#39;mfa_device&#39; },  institution_id: &#39;ins_109508&#39;, 
initial_products: %i(transactions auth))</p>

<p>access_token = <a href="'access_token'">response</a>  response =
answer_mfa(client, access_token, response) while
response.key?(&#39;mfa_type&#39;) rescue <a
href="../classes/Plaid/PlaidError.html">Plaid::PlaidError</a>  raise
&#39;Error in main flow.&#39; end “`</p>

<h3 id="label-Deleting+an+item">Deleting an item</h3>

<pre><code>require &#39;plaid&#39;

client = Plaid::Client.new(env: :sandbox,
                           client_id: &#39;***&#39;,
                           secret: &#39;***&#39;,
                           public_key: &#39;***&#39;)

response = client.item.create(credentials: { username: &#39;user_good&#39;,
                                             password: &#39;pass_good&#39; },
                              institution_id: &#39;ins_109509&#39;,
                              initial_products: %i(auth identity transactions))

access_token = response[&#39;access_token&#39;]

# Provide the access_token for the Item you want to delete
client.item.delete(access_token)
</code></pre>

<h3 id="label-Get+paginated+transactions">Get paginated transactions</h3>

<pre><code>require &#39;plaid&#39;

client = Plaid::Client.new(env: :sandbox,
                           client_id: &#39;***&#39;,
                           secret: &#39;***&#39;,
                           public_key: &#39;***&#39;)

item_response = client.item.create(credentials: { username: &#39;user_good&#39;,
                                                  password: &#39;pass_good&#39; },
                                   institution_id: &#39;ins_109509&#39;,
                                   initial_products: %i(auth identity transactions))

access_token = item_response[&#39;access_token&#39;]

transaction_response = client.transactions.get(access_token, &#39;2016-07-12&#39;, &#39;2017-01-09&#39;)
transactions = transaction_response[&#39;transactions&#39;]

# the transactions in the response are paginated, so make multiple calls while
# increasing the offset to retrieve all transactions
while transactions.length &lt; transaction_response[&#39;total_transactions&#39;]
  transaction_response = client.transactions.get(access_token,
                                                 &#39;2016-07-12&#39;,
                                                 &#39;2017-01-09&#39;,
                                                 offset: transactions.length)
  transactions += transaction_response[&#39;transactions&#39;]
end
</code></pre>

<h3 id="label-Obtaining+user-related+data">Obtaining user-related data</h3>

<p>If you have an <code>access_token</code>, you can use following code to
retreive data: “`ruby require &#39;plaid&#39;</p>

<p>client = <a
href="../classes/Plaid/Client.html#method-c-new">Plaid::Client.new</a>(env:
:sandbox,  client_id: &#39;<strong><em>&#39;,  secret:
&#39;</em></strong>&#39;,  public_key: &#39;<em>*</em>&#39;)</p>

<p>item_response = client.item.create(credentials: { username:
&#39;user_good&#39;,  password: &#39;pass_good&#39; },  institution_id:
&#39;ins_109509&#39;,  initial_products: %i(auth identity transactions))</p>

<p>access_token = <a href="'access_token'">item_response</a></p>

<p>auth_response = client.auth.get(access_token) auth = <a
href="'auth'">auth_response</a></p>

<pre><code>
### Create a Stripe bank_account_token

Exchange a Plaid Link `public_token` for an API `access_token` and a Stripe `bank_account_token`:</code></pre>

<p>ruby require &#39;plaid&#39;</p>

<p>client = <a
href="../classes/Plaid/Client.html#method-c-new">Plaid::Client.new</a>(env:
:sandbox,  client_id: &#39;<strong><em>&#39;,  secret:
&#39;</em></strong>&#39;,  public_key: &#39;<em>*</em>&#39;)</p>

<p>exchange_token_response = client.item.public_token.exchange(&#39;[Plaid
Link public_token]&#39;) access_token = <a
href="'access_token'">exchange_token_response</a></p>

<p>stripe_response =
client.processor.stripe.bank_account_token.create(access_token,
&#39;[Account ID]&#39;) bank_account_token = <a
href="'stripe_bank_account_token'">stripe_response</a></p>

<pre><code>
There are also a number of other methods you can use to retrieve data:

* `client.accounts.get(access_code, ...)`: accounts
* `client.accounts.balance.get(access_code, ...)`: real-time balances
* `client.auth.get(access_code, ...)`: auth
* `client.identity.get(access_code, ...)`: identity
* `client.transactions.get(access_code, ...)`: transactions
* `client.credit_details.get(access_code, ...)`: credit details

All of these methods return appropriate data. More information and especially information about fields available in all the returned hashes can be found on the [API documentation](https://plaid.com/docs/api).

### Categories

You can request category information:</code></pre>

<p>ruby categories = client.categories.get # Array of all known categories “`</p>

<h3 id="label-Institutions">Institutions</h3>

<p>Financial institution information is available as shown below where the
function arguments represent count and offset:</p>

<pre><code>institutions = client.institutions.get(count: 3, offset: 1)
</code></pre>

<h2 id="label-Errors">Errors</h2>

<p>Any methods making API calls will result in an exception raised unless the
response code is “200: Success” or “210: MFA Required”.</p>

<p><code>Plaid::InvalidRequestError</code> is returned when the request is
malformed and cannot be processed.</p>

<p><code>Plaid::InvalidInputError</code> is returned when all fields are
provided and are in the correct format, but the values provided are
incorrect in some way.</p>

<p><code>Plaid::RateLimitExceededError</code> returned when the request is
valid but has exceeded established rate limits.</p>

<p><code>Plaid::APIError</code> is returned during planned maintenance windows
and in response to API internal server errors.</p>

<p><code>Plaid::ItemError</code> indicates that information provided for the
Item (such as credentials or MFA) may be invalid or that the Item is not
supported on Plaid&#39;s platform.</p>

<p>Read more about response codes and their meaning in the <a
href="https://plaid.com/docs/api">Plaid documentation</a>.</p>

<h2 id="label-Network+Timeout">Network Timeout</h2>

<p>A network timeout value is set in the <code>lib/plaid/connect.rb</code>
file. It is currently defaulted at 600 (in seconds) which equates to about
10 minutes. Some requests from the <a
href="../classes/Plaid.html">Plaid</a> API may take longer than others and
we want to make sure that all valid requests have a chance to complete.
Adjust this value if necessary.</p>

<h2 id="label-Contributing">Contributing</h2>

<p>Bug reports and pull requests are welcome on GitHub at <a
href="https://github.com/plaid/plaid-ruby">github.com/plaid/plaid-ruby</a>.
See also <a href="CONTRIBUTING.md">contributing guidelines</a>.</p>

<h2 id="label-License">License</h2>

<p>The gem is available as open source under the terms of the <a
href="http://opensource.org/licenses/MIT">MIT License</a>.</p>

    </div>
  


  


  
  


  


  

  



  

    

    

    


    


    <!-- Methods -->
              </div>

    </div>
  </body>
</html>
